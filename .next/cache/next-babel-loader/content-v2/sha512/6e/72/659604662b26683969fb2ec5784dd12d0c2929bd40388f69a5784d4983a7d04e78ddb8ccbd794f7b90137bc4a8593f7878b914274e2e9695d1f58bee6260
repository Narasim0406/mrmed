{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { userDetails, userToken } from '../../../actions';\nimport styles from './SingnInComponent.module.scss';\nimport { Modal } from 'reactstrap';\nimport CarouselForAll from '../CarouselForLogIn/index';\nimport jwt_decode from \"jwt-decode\";\nimport { auth_url } from '../../../apiVariables';\nexport default function SingnInComponent(props) {\n  var dispatch = useDispatch();\n\n  var _useState = useState(\"\"),\n      token = _useState[0],\n      setToken = _useState[1];\n\n  var _useState2 = useState({}),\n      decoded = _useState2[0],\n      setDecoded = _useState2[1];\n\n  var _useState3 = useState(0),\n      which = _useState3[0],\n      setWhich = _useState3[1];\n\n  var _useState4 = useState(\"\"),\n      emailIdMobileNo = _useState4[0],\n      setemailIdMobileNo = _useState4[1];\n\n  var _useState5 = useState({\n    code1: \"\",\n    code2: \"\",\n    code3: \"\",\n    code4: \"\",\n    code5: \"\",\n    code6: \"\"\n  }),\n      otp = _useState5[0],\n      setOtp = _useState5[1];\n\n  var _useState6 = useState({\n    name: '',\n    emailId: '',\n    phoneNo: '',\n    mobileVerifyStatus: 1,\n    userTypeId: 3\n  }),\n      signUpData = _useState6[0],\n      setSignUpData = _useState6[1];\n\n  useEffect(function () {\n    setWhich(0);\n  }, []);\n\n  var handelSignIn = function handelSignIn() {\n    setWhich(0);\n  };\n\n  var handelSignUp = function handelSignUp() {\n    setWhich(1);\n  };\n\n  var handelOtp = function handelOtp() {\n    setWhich(2);\n  };\n\n  var onChangeForm = function onChangeForm(e) {\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value;\n    setSignUpData(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, name, value));\n    });\n  };\n\n  var onChangeOtp = function onChangeOtp(e) {\n    var _e$target2 = e.target,\n        name = _e$target2.name,\n        value = _e$target2.value;\n    setOtp(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, name, value));\n    });\n  };\n\n  var handleSignInData = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var url, isNewUser, data, res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              url = \"\".concat(auth_url, \"/user/signInByEmailPhone\");\n              isNewUser = emailIdMobileNo === signUpData.phoneNo ? true : false;\n              data = isNewUser ? {\n                emailIdMobileNo: emailIdMobileNo,\n                isNewUser: isNewUser\n              } : {\n                emailIdMobileNo: emailIdMobileNo\n              };\n              console.log(data);\n              _context.next = 7;\n              return httpPostRequest(url, data);\n\n            case 7:\n              res = _context.sent;\n              console.log(res);\n\n              if (res.status === 200) {\n                alert(res.message);\n                handelOtp();\n              } else if (res.status == 404) {\n                alert(\"mobile or email not registered\");\n              }\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleSignInData(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var verifyOtp = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      var url, code, isNewUser, data, res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n              url = \"\".concat(auth_url, \"/user/verifySignInByEmailPhone\");\n              code = otp.code1 + otp.code2 + otp.code3 + otp.code4 + otp.code5 + otp.code6;\n              isNewUser = emailIdMobileNo === signUpData.phoneNo ? true : false;\n              data = {\n                emailIdMobileNo: emailIdMobileNo,\n                isNewUser: isNewUser,\n                code: code\n              };\n              _context2.next = 7;\n              return httpPostRequest(url, data);\n\n            case 7:\n              res = _context2.sent;\n              console.log(res);\n\n              if (res.status === 200) {\n                alert(res.message);\n                setOtp({\n                  code1: \"\",\n                  code2: \"\",\n                  code3: \"\",\n                  code4: \"\",\n                  code5: \"\",\n                  code6: \"\"\n                });\n                signUp();\n              } else {\n                alert(\"otp verification failed\");\n              }\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function verifyOtp(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var signUp = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var url, data, res, decodeds;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              url = \"\".concat(auth_url, \"/user/signup\");\n              data = signUpData;\n              _context3.next = 4;\n              return httpPostRequest(url, data);\n\n            case 4:\n              res = _context3.sent;\n              console.log(res);\n\n              if (!(res.status === 200)) {\n                _context3.next = 18;\n                break;\n              }\n\n              alert(res.message);\n              setToken(res.data.token);\n              _context3.next = 11;\n              return jwt_decode(token);\n\n            case 11:\n              decodeds = _context3.sent;\n              setDecoded(decodeds);\n              dispatch(userDetails(decoded));\n              dispatch(userToken(token));\n              console.log(decoded); //res.data.userData\n\n              _context3.next = 19;\n              break;\n\n            case 18:\n              if (res.status === 400) {\n                alert(\"User Already has Registered\");\n              }\n\n            case 19:\n              console.log(signUpData);\n              setSignUpData({\n                name: '',\n                emailId: '',\n                phoneNo: '',\n                userTypeId: 1,\n                mobileVerifyStatus: 1\n              });\n\n            case 21:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function signUp() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleSignUpData = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              e.preventDefault();\n              handelSignIn();\n              setemailIdMobileNo(signUpData.phoneNo);\n\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function handleSignUpData(_x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var httpPostRequest = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(url, body) {\n      var result;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              console.log(body);\n              _context5.next = 3;\n              return fetch(url, {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(body)\n              });\n\n            case 3:\n              result = _context5.sent;\n              _context5.next = 6;\n              return result;\n\n            case 6:\n              return _context5.abrupt(\"return\", _context5.sent);\n\n            case 7:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function httpPostRequest(_x4, _x5) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Modal, {\n    isOpen: props.modal,\n    toggle: props.toggle,\n    className: styles.signInUpModal\n  }, which === 0 ? __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-5\"\n  }, __jsx(\"div\", {\n    className: styles.signIn\n  }, __jsx(\"div\", {\n    className: styles.signInCard\n  }, __jsx(\"form\", {\n    method: \"post\",\n    onSubmit: handleSignInData\n  }, __jsx(\"div\", {\n    className: styles.signinInput\n  }, __jsx(\"p\", {\n    className: styles.signinHeader\n  }, \"Welcome to MrMed\"), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.singninFormInput,\n    name: \"mobileNo\",\n    placeholder: \"Mobile number\",\n    value: emailIdMobileNo,\n    onChange: function onChange(e) {\n      return setemailIdMobileNo(e.target.value);\n    },\n    required: true\n  })), __jsx(\"div\", {\n    className: styles.signinBtns\n  }, __jsx(\"button\", {\n    className: styles.verifyBtn\n  }, \"VERIFY NUMBER\"), __jsx(\"p\", {\n    className: styles.noAccount\n  }, \"Don't have account ? \", __jsx(\"span\", {\n    className: styles.register,\n    onClick: handelSignUp\n  }, \"Register\"))))))), __jsx(\"div\", {\n    className: \"col-md-7\"\n  }, __jsx(CarouselForAll, null))) : \"\", which === 1 ? __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-5\"\n  }, __jsx(\"div\", {\n    className: styles.signUp\n  }, __jsx(\"div\", {\n    className: styles.signupContent\n  }, __jsx(\"div\", null, __jsx(\"p\", {\n    className: styles.signupHeader\n  }, \"Welcome to MrMed\"), __jsx(\"p\", {\n    className: styles.register\n  }, \"Register\"), __jsx(\"form\", {\n    method: \"post\",\n    onSubmit: handleSignUpData\n  }, __jsx(\"div\", {\n    className: styles.signupMain\n  }, __jsx(\"input\", {\n    type: \"text\",\n    className: styles.signupFormInput,\n    name: \"name\",\n    placeholder: \"Name\",\n    value: signUpData.name,\n    onChange: function onChange(e) {\n      return onChangeForm(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.signupFormInput,\n    name: \"emailId\",\n    placeholder: \"Email Address\",\n    value: signUpData.emailId,\n    onChange: function onChange(e) {\n      return onChangeForm(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.signupFormInput,\n    name: \"phoneNo\",\n    placeholder: \"MobileNumber\",\n    value: signUpData.phoneNo,\n    onChange: function onChange(e) {\n      return onChangeForm(e);\n    },\n    required: true\n  })), __jsx(\"button\", {\n    className: styles.sverifyBtn\n  }, \"SIGN UP\"))), __jsx(\"div\", {\n    className: styles.accountsMain\n  }, __jsx(\"div\", {\n    className: styles.nosignAccooun\n  }, __jsx(\"p\", {\n    className: styles.nosignupAccount\n  }, \"Already have an account ? \", __jsx(\"span\", {\n    onClick: handelSignIn\n  }, \"Login\"))), __jsx(\"div\", {\n    className: styles.signupFooter\n  }, __jsx(\"p\", {\n    className: styles.termsCont\n  }, \"By continuing  you agree to the to our \", __jsx(\"span\", null, \"Terms of use and Privacy policy\"))))))), __jsx(\"div\", {\n    className: \"col-md-7\"\n  }, __jsx(CarouselForAll, null))) : \"\", which === 2 ? __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-5\"\n  }, __jsx(\"div\", {\n    className: styles.otpLogin_inner\n  }, __jsx(\"div\", {\n    className: styles.textContent\n  }, __jsx(\"p\", {\n    className: styles.otp_header\n  }, \"Verify OTP\"), __jsx(\"p\", {\n    className: styles.otp_number\n  }, \"Please enter the OTP code sent to your \", __jsx(\"br\", null), \" mobile number +91 98783 87377\")), __jsx(\"form\", {\n    method: \"post\",\n    onSubmit: verifyOtp\n  }, __jsx(\"div\", {\n    className: styles.otpno_container\n  }, __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code1\",\n    value: otp.code1,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    maxLength: \"1\",\n    required: true,\n    placeholder: \"0\"\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code2\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code2,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code3\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code3,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code4\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code4,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code5\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code5,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code6\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code6,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    required: true\n  })), __jsx(\"div\", {\n    className: styles.btnContainer\n  }, __jsx(\"button\", {\n    className: styles.otp_verify\n  }, \"VERIFY\"))))), __jsx(\"div\", {\n    className: \"col-md-7\"\n  }, __jsx(CarouselForAll, null))) : \"\");\n}","map":null,"metadata":{},"sourceType":"module"}