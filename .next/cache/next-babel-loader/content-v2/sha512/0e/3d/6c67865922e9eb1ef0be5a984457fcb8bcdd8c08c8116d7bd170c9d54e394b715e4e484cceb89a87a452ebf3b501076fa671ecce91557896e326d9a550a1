{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { userDetails, userToken } from '../../../actions';\nimport styles from './SingnInComponent.module.scss';\nimport { Modal } from 'reactstrap';\nimport CarouselForAll from '../CarouselForLogIn/index';\nimport jwt_decode from \"jwt-decode\";\nimport { auth_url } from '../../../apiVariables';\nimport axios from 'axios';\nexport default function SingnInComponent(props) {\n  const dispatch = useDispatch();\n  let {\n    0: token,\n    1: setToken\n  } = useState(\"\");\n  let {\n    0: isSignUp,\n    1: handleIsSignup\n  } = useState(false);\n  const {\n    0: decoded,\n    1: setDecoded\n  } = useState({});\n  const {\n    0: which,\n    1: setWhich\n  } = useState(0);\n  const {\n    0: emailIdMobileNo,\n    1: setemailIdMobileNo\n  } = useState(\"\");\n  const {\n    0: otp,\n    1: setOtp\n  } = useState({\n    code1: \"\",\n    code2: \"\",\n    code3: \"\",\n    code4: \"\",\n    code5: \"\",\n    code6: \"\"\n  });\n  const {\n    0: signUpData,\n    1: setSignUpData\n  } = useState({\n    name: \"\",\n    emailId: \"\",\n    mobileNo: \"\",\n    userTypeId: 3,\n    mobileVerifyStatus: 1\n  });\n  useEffect(() => {\n    setWhich(0);\n  }, []);\n\n  const handelSignIn = () => {\n    handleIsSignup(true);\n    setWhich(0);\n  };\n\n  const handelSignUp = () => {\n    handleIsSignup(true);\n    setWhich(1);\n  };\n\n  const handelOtp = () => {\n    setWhich(2);\n  };\n\n  const onChangeForm = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setSignUpData(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      [name]: value\n    }));\n  };\n\n  const onChangeOtp = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setOtp(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      [name]: value\n    }));\n\n    if (value === \"\") {\n      handleBackspace(e);\n    } else {\n      handleEnter(e);\n    }\n  };\n\n  const handleSignInData = async e => {\n    e.preventDefault();\n    handleIsSignup(false);\n    const url = `${auth_url}/user/signInByEmailPhone`;\n    let isNewUser = emailIdMobileNo === signUpData.mobileNo ? true : false;\n    let data = isNewUser ? {\n      emailIdMobileNo,\n      isNewUser\n    } : {\n      emailIdMobileNo\n    };\n    let res = await axios.post(url, data);\n\n    if (res.status === 200) {\n      console.log(res.data);\n      if (isNewUser === true) signUp();\n      handelOtp();\n    } else if (res.status === 404) {// alert(res.statusText)\n    }\n  };\n\n  const verifyOtp = async e => {\n    e.preventDefault();\n\n    if (isSignUp === false) {\n      signInVerify();\n    } else {\n      signUpVerify();\n    }\n  };\n\n  const signUpVerify = async () => {\n    const url = `${auth_url}/user/verifySignInByEmailPhone`;\n    let code = otp.code1 + otp.code2 + otp.code3 + otp.code4 + otp.code5 + otp.code6;\n    let isNewUser = true;\n    let data = {\n      emailIdMobileNo,\n      isNewUser,\n      code\n    };\n    let res = await axios.post(url, data);\n\n    if (res.status === 200 || res.status === \"success\") {\n      setOtp({\n        code1: \"\",\n        code2: \"\",\n        code3: \"\",\n        code4: \"\",\n        code5: \"\",\n        code6: \"\"\n      });\n      localStorage.setItem('token', res.data.data.token);\n      localStorage.setItem('userData', JSON.stringify(res.data.data.userData));\n      console.log(res, \"verifyOtp\", localStorage);\n      signUp();\n    } else {// alert(\"otp verification failed\")\n    }\n  };\n\n  const signInVerify = async () => {\n    const url = `${auth_url}/user/verifySignInByEmailPhone`;\n    let code = otp.code1 + otp.code2 + otp.code3 + otp.code4 + otp.code5 + otp.code6;\n    let isNewUser = false;\n    let data = {\n      emailIdMobileNo,\n      isNewUser,\n      code\n    };\n    let res = await axios.post(url, data);\n\n    if (res.status === 200 || res.status == \"success\") {\n      setOtp({\n        code1: \"\",\n        code2: \"\",\n        code3: \"\",\n        code4: \"\",\n        code5: \"\",\n        code6: \"\"\n      });\n      localStorage.setItem('token', res.data.data.token);\n      localStorage.setItem('userData', JSON.stringify(res.data.data.userData));\n      console.log(res, \"verifyOtp\", localStorage); // if(isNewUser===false){\n      //     dispatch(userDetails(res.data.data.token));\n      //     dispatch(userToken(res.data.data.userData));\n      // }\n\n      props.toggle();\n    } else {// alert(\"otp verification failed\")\n    }\n  };\n\n  const signUp = async () => {\n    const url = `${auth_url}/user/signup`;\n    console.log(signUpData, \"signUpData\");\n    let res = await axios.post(url, signUpData);\n\n    if (res.status === 200 || res.status === \"success\") {\n      console.log(res.data, \"signUp\");\n      dispatch(userDetails(res.data.data.token));\n      dispatch(userToken(res.data.data.userData));\n      props.toggle();\n      setSignUpData({\n        name: '',\n        emailId: '',\n        mobileNo: '',\n        userTypeId: 3,\n        mobileVerifyStatus: 1\n      });\n    } else if (res.status === 400) {// alert(\"User Already has Registered\");\n    }\n  };\n\n  const handleSignUpData = async e => {\n    e.preventDefault();\n    handleIsSignup(true);\n    setemailIdMobileNo(signUpData.mobileNo);\n    sendSignUpOtp();\n  };\n\n  const sendSignUpOtp = async () => {\n    handleIsSignup(false);\n    const url = `${auth_url}/user/signInByEmailPhone`;\n    let isNewUser = true;\n    let data = {\n      \"emailIdMobileNo\": signUpData.mobileNo,\n      \"isNewUser\": true\n    };\n    let res = await axios.post(url, data);\n\n    if (res.status === 200 || res.status === \"success\") {\n      handelOtp();\n    }\n  };\n\n  function handleEnter(event) {\n    console.log(event.keyCode, \"sdfgsdhsdf\");\n    const form = event.target.form;\n    const index = Array.prototype.indexOf.call(form, event.target);\n    console.log(form, index, \"sdfgsdhsdf\");\n\n    if (index !== 5) {\n      form.elements[index + 1].focus();\n      event.preventDefault();\n    }\n  }\n\n  function handleBackspace(event) {\n    console.log(event.keyCode, \"sdfgsdhsdf\");\n    const form = event.target.form;\n    const index = Array.prototype.indexOf.call(form, event.target);\n    console.log(form, index, \"sdfgsdhsdf\");\n\n    if (index !== 0) {\n      form.elements[index - 1].focus();\n      event.preventDefault();\n    }\n  }\n\n  return __jsx(Modal, {\n    isOpen: props.modal,\n    toggle: props.toggle,\n    className: styles.signInUpModal\n  }, which === 0 ? __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-5\"\n  }, __jsx(\"div\", {\n    className: styles.signIn\n  }, __jsx(\"div\", {\n    className: styles.signInCard\n  }, __jsx(\"form\", {\n    method: \"post\",\n    onSubmit: handleSignInData\n  }, __jsx(\"div\", {\n    className: styles.signinInput\n  }, __jsx(\"p\", {\n    className: styles.signinHeader\n  }, \"Welcome to MrMed\"), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.singninFormInput,\n    name: \"mobileNo\",\n    placeholder: \"Mobile number\",\n    value: emailIdMobileNo,\n    onChange: e => setemailIdMobileNo(e.target.value),\n    required: true\n  })), __jsx(\"div\", {\n    className: styles.signinBtns\n  }, __jsx(\"button\", {\n    className: styles.verifyBtn\n  }, \"VERIFY NUMBER\"), __jsx(\"p\", {\n    className: styles.noAccount\n  }, \"Don't have account ? \", __jsx(\"span\", {\n    className: styles.register,\n    onClick: handelSignUp\n  }, \"Register\"))))))), __jsx(\"div\", {\n    className: \"col-md-7\"\n  }, __jsx(CarouselForAll, null))) : \"\", which === 1 ? __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-5\"\n  }, __jsx(\"div\", {\n    className: styles.signUp\n  }, __jsx(\"div\", {\n    className: styles.signupContent\n  }, __jsx(\"div\", null, __jsx(\"p\", {\n    className: styles.signupHeader\n  }, \"Welcome to MrMed\"), __jsx(\"p\", {\n    className: styles.register\n  }, \"Register\"), __jsx(\"form\", {\n    method: \"post\",\n    onSubmit: handleSignUpData\n  }, __jsx(\"div\", {\n    className: styles.signupMain\n  }, __jsx(\"input\", {\n    type: \"text\",\n    className: styles.signupFormInput,\n    name: \"name\",\n    placeholder: \"Name\",\n    value: signUpData.name,\n    onChange: e => onChangeForm(e),\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.signupFormInput,\n    name: \"emailId\",\n    placeholder: \"Email Address\",\n    value: signUpData.emailId,\n    onChange: e => onChangeForm(e),\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.signupFormInput,\n    name: \"mobileNo\",\n    placeholder: \"MobileNumber\",\n    value: signUpData.mobileNo,\n    onChange: e => onChangeForm(e),\n    required: true\n  })), __jsx(\"button\", {\n    className: styles.sverifyBtn\n  }, \"SIGN UP\"))), __jsx(\"div\", {\n    className: styles.accountsMain\n  }, __jsx(\"div\", {\n    className: styles.nosignAccooun\n  }, __jsx(\"p\", {\n    className: styles.nosignupAccount\n  }, \"Already have an account ? \", __jsx(\"span\", {\n    onClick: handelSignIn\n  }, \"Login\"))), __jsx(\"div\", {\n    className: styles.signupFooter\n  }, __jsx(\"p\", {\n    className: styles.termsCont\n  }, \"By continuing  you agree to the to our \", __jsx(\"span\", null, \"Terms of use and Privacy policy\"))))))), __jsx(\"div\", {\n    className: \"col-md-7\"\n  }, __jsx(CarouselForAll, null))) : \"\", which === 2 ? __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-5\"\n  }, __jsx(\"div\", {\n    className: styles.otpLogin_inner\n  }, __jsx(\"div\", {\n    className: styles.textContent\n  }, __jsx(\"p\", {\n    className: styles.otp_header\n  }, \"Verify OTP\"), __jsx(\"p\", {\n    className: styles.otp_number\n  }, \"Please enter the OTP code sent to your \", __jsx(\"br\", null), \" mobile number +91 \", emailIdMobileNo)), __jsx(\"form\", {\n    method: \"post\",\n    onSubmit: verifyOtp\n  }, __jsx(\"div\", {\n    className: styles.otpno_container,\n    id: \"otp-screen\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code1\",\n    value: otp.code1,\n    onChange: e => onChangeOtp(e),\n    maxLength: \"1\",\n    required: true,\n    placeholder: \"0\"\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code2\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code2,\n    onChange: e => onChangeOtp(e),\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code3\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code3,\n    onChange: e => onChangeOtp(e),\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code4\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code4,\n    onChange: e => onChangeOtp(e),\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code5\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code5,\n    onChange: e => onChangeOtp(e),\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code6\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code6,\n    onChange: e => onChangeOtp(e),\n    required: true\n  })), __jsx(\"div\", {\n    className: styles.btnContainer\n  }, __jsx(\"button\", {\n    className: styles.otp_verify\n  }, \"VERIFY\"))))), __jsx(\"div\", {\n    className: \"col-md-7\"\n  }, __jsx(CarouselForAll, null))) : \"\");\n}","map":null,"metadata":{},"sourceType":"module"}