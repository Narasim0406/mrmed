{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, useEffect } from 'react'; //import SignIn from '../../Login/Signin';\n\nimport styles from './ImportedForm.module.scss';\nimport { useDispatch } from 'react-redux';\nimport { userDetails } from '../../../actions';\nimport { medplans_url } from '../../../apiVariables';\nimport axios from 'axios';\nimport jwt_decode from \"jwt-decode\";\nimport RegConfirm from '../RegConformation/index';\n\nfunction ImportedForm() {\n  const dispatch = useDispatch();\n  const {\n    0: modal,\n    1: setModal\n  } = useState(false);\n  const {\n    0: importedRegister,\n    1: setImportedRegister\n  } = useState({\n    userId: \"601cd4f10787cd421e6f6acc\",\n    medicineDetails: \"\",\n    quantity: \"\",\n    notes: \"\",\n    status: 0\n  });\n  const {\n    0: prescriptionUrl,\n    1: setPrescritpionUrl\n  } = useState([]);\n  const {\n    0: documentUrl,\n    1: setDocumentUrl\n  } = useState([]);\n  const {\n    0: userData,\n    1: setuserData\n  } = useState({});\n  useEffect(() => {\n    if (localStorage.userData) {\n      dispatch(userDetails(JSON.parse(localStorage.userData)));\n      setuserData(JSON.parse(localStorage.userData));\n    }\n  }, []);\n\n  const uploadDocuments = async documents => {\n    const url = `http://180.151.69.138:2258/api/v1/upload/uploadFile/single`;\n    console.log(documents, \"documents\");\n    let docs = [];\n\n    if (documents) {\n      for (var i = 0; i < documents.length; i++) {\n        async function call() {\n          let formData = new FormData();\n          let file = documents[i];\n          formData.append(\"file\", file);\n          let res = await axios.post(url, formData, {\n            headers: {\n              \"Content-Type\": \"multipart/form-data\"\n            }\n          });\n\n          if (res.status === 200) {\n            console.log(res.data.data.url);\n            docs.push(res.data.data.url);\n          }\n        }\n\n        await call();\n      }\n    }\n\n    return docs;\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    let {\n      medicineDetails,\n      quantity,\n      notes\n    } = importedRegister;\n    const prescriptionUrls = uploadDocuments(prescriptionUrl);\n    const documentUrls = uploadDocuments(documentUrl); //console.log({prescriptionUrls,documentUrls});\n\n    let user = jwt_decode(userData.token);\n    let data = {\n      userId: user && user.id,\n      userName: user && user.name,\n      medicineDetails,\n      quantity,\n      notes,\n      prescriptionUrls,\n      documentUrls,\n      status: 0,\n      address: \"344B\",\n      addressName: \"bharathi\",\n      addressMobile: \"9290876754\",\n      addressCity: \"salem\",\n      addressState: \"tamilnadu\",\n      addressPincode: \"636010\",\n      addressLandmark: \"temple\",\n      addressType: \"home\"\n    };\n    const url = `${medplans_url}/import`;\n    let res = await axios.post(url, data);\n\n    if (res.status === 200) {\n      setImportedRegister({\n        medicineDetails: \"\",\n        quantity: \"\",\n        notes: \"\",\n        status: 0\n      });\n      setPrescritpionUrl([]);\n      setDocumentUrl([]);\n    }\n\n    toggle();\n  };\n\n  const toggle = () => {\n    setModal(!modal);\n  };\n\n  const onChangeForm = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setImportedRegister(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      [name]: value\n    }));\n  };\n\n  const handleDocument = e => {\n    setDocumentUrl(e.target.files);\n  };\n\n  const handlePrescription = e => {\n    setPrescritpionUrl(e.target.files);\n  };\n\n  return __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-8\"\n  }, __jsx(\"div\", {\n    className: styles.formBorder\n  }, __jsx(\"div\", {\n    className: styles.provideDetail\n  }, __jsx(\"b\", null, \"Provide Details of Medicines\")), __jsx(\"form\", {\n    onSubmit: handleSubmit\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-6\"\n  }, __jsx(\"div\", {\n    className: styles.medDetail\n  }, __jsx(\"span\", null, \"Medicine Details\")), __jsx(\"input\", {\n    className: styles.detailField,\n    type: \"text\",\n    name: \"medicineDetails\",\n    placeholder: \"Enter here\",\n    value: importedRegister.medicineDetails,\n    onChange: e => onChangeForm(e),\n    required: true\n  })), __jsx(\"div\", {\n    className: \"col-6\"\n  }, __jsx(\"div\", {\n    className: styles.medDetail\n  }, __jsx(\"span\", null, \"Quantity\")), __jsx(\"input\", {\n    className: styles.detailField,\n    type: \"text\",\n    name: \"quantity\",\n    placeholder: \"Enter here\",\n    value: importedRegister.quantity,\n    onChange: e => onChangeForm(e),\n    required: true\n  }))), __jsx(\"div\", {\n    className: styles.note\n  }, __jsx(\"span\", null, \"Notes\")), __jsx(\"textarea\", {\n    className: styles.notesField,\n    placeholder: \"Enter here\",\n    name: \"notes\",\n    value: importedRegister.notes,\n    onChange: e => onChangeForm(e),\n    required: true\n  }), __jsx(\"div\", {\n    className: styles.Label\n  }, __jsx(\"span\", null, \"Upload  Your Prescription\")), __jsx(\"div\", {\n    className: styles.uploadField\n  }, __jsx(\"img\", {\n    src: '/upload.png'\n  }), __jsx(\"br\", null), __jsx(\"span\", null, \"Upload prescription or photo here\"), __jsx(\"br\", null), __jsx(\"label\", {\n    className: styles.uploadLabel,\n    htmlFor: styles.uploadFile1\n  }, __jsx(\"b\", null, \"Browse files\")), __jsx(\"input\", {\n    type: \"file\",\n    id: styles.uploadFile1,\n    multiple: true,\n    onChange: e => handlePrescription(e)\n  })), __jsx(\"div\", {\n    className: styles.Label\n  }, __jsx(\"span\", null, \"Upload Documents\")), __jsx(\"div\", {\n    className: styles.uploadField\n  }, __jsx(\"img\", {\n    src: '/upload.png'\n  }), __jsx(\"br\", null), __jsx(\"span\", null, \"Upload any other related documents\"), __jsx(\"br\", null), __jsx(\"label\", {\n    className: styles.uploadLabel,\n    htmlFor: styles.uploadFile\n  }, __jsx(\"b\", null, \"Browse files\")), __jsx(\"input\", {\n    type: \"file\",\n    id: styles.uploadFile,\n    multiple: true,\n    onChange: e => handleDocument(e)\n  })), __jsx(\"div\", {\n    className: \"submit\"\n  }, __jsx(\"button\", {\n    type: \"submit\",\n    className: styles.btnSubmit\n  }, __jsx(\"b\", null, \"SUBMIT YOUR REQUEST\")))))), __jsx(RegConfirm, {\n    modal: modal,\n    toggle: toggle\n  }));\n}\n\nexport default ImportedForm;","map":null,"metadata":{},"sourceType":"module"}