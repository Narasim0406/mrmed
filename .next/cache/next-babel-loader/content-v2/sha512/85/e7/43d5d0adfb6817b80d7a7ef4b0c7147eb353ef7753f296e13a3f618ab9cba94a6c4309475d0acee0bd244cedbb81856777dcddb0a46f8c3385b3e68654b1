{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { userDetails, userToken } from '../../../actions';\nimport styles from './SingnInComponent.module.scss';\nimport { Modal } from 'reactstrap';\nimport CarouselForAll from '../CarouselForLogIn/index';\nimport jwt_decode from \"jwt-decode\";\nimport { auth_url } from '../../../apiVariables';\nimport axios from 'axios';\nexport default function SingnInComponent(props) {\n  var dispatch = useDispatch();\n\n  var _useState = useState(\"\"),\n      token = _useState[0],\n      setToken = _useState[1];\n\n  var _useState2 = useState(false),\n      isSignUp = _useState2[0],\n      handleIsSignup = _useState2[1];\n\n  var _useState3 = useState({}),\n      decoded = _useState3[0],\n      setDecoded = _useState3[1];\n\n  var _useState4 = useState(0),\n      which = _useState4[0],\n      setWhich = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      emailIdMobileNo = _useState5[0],\n      setemailIdMobileNo = _useState5[1];\n\n  var _useState6 = useState({\n    code1: \"\",\n    code2: \"\",\n    code3: \"\",\n    code4: \"\",\n    code5: \"\",\n    code6: \"\"\n  }),\n      otp = _useState6[0],\n      setOtp = _useState6[1];\n\n  var _useState7 = useState({\n    name: \"\",\n    emailId: \"\",\n    mobileNo: \"\",\n    userTypeId: 3,\n    mobileVerifyStatus: 1\n  }),\n      signUpData = _useState7[0],\n      setSignUpData = _useState7[1];\n\n  useEffect(function () {\n    setWhich(0);\n  }, []);\n\n  var handelSignIn = function handelSignIn() {\n    handleIsSignup(true);\n    setWhich(0);\n  };\n\n  var handelSignUp = function handelSignUp() {\n    handleIsSignup(true);\n    setWhich(1);\n  };\n\n  var handelOtp = function handelOtp() {\n    setWhich(2);\n  };\n\n  var onChangeForm = function onChangeForm(e) {\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value;\n    setSignUpData(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, name, value));\n    });\n  };\n\n  var onChangeOtp = function onChangeOtp(e) {\n    var _e$target2 = e.target,\n        name = _e$target2.name,\n        value = _e$target2.value;\n    setOtp(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, name, value));\n    });\n\n    if (value === \"\") {\n      handleBackspace(e);\n    } else {\n      handleEnter(e);\n    }\n  };\n\n  var handleSignInData = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var url, isNewUser, data, res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              handleIsSignup(false);\n              url = \"\".concat(auth_url, \"/user/signInByEmailPhone\");\n              isNewUser = emailIdMobileNo === signUpData.mobileNo ? true : false;\n              data = isNewUser ? {\n                emailIdMobileNo: emailIdMobileNo,\n                isNewUser: isNewUser\n              } : {\n                emailIdMobileNo: emailIdMobileNo\n              };\n              _context.next = 7;\n              return axios.post(url, data);\n\n            case 7:\n              res = _context.sent;\n\n              if (res.status === 200) {\n                console.log(res.data);\n                if (isNewUser === true) signUp();\n                handelOtp();\n              } else if (res.status === 404) {// alert(res.statusText)\n              }\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleSignInData(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var verifyOtp = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n\n              if (isSignUp === false) {\n                signInVerify();\n              } else {\n                signUpVerify();\n              }\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function verifyOtp(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var signUpVerify = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var url, code, isNewUser, data, res;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              url = \"\".concat(auth_url, \"/user/verifySignInByEmailPhone\");\n              code = otp.code1 + otp.code2 + otp.code3 + otp.code4 + otp.code5 + otp.code6;\n              isNewUser = true;\n              data = {\n                emailIdMobileNo: emailIdMobileNo,\n                isNewUser: isNewUser,\n                code: code\n              };\n              _context3.next = 6;\n              return axios.post(url, data);\n\n            case 6:\n              res = _context3.sent;\n\n              if (res.status === 200 || res.status === \"success\") {\n                setOtp({\n                  code1: \"\",\n                  code2: \"\",\n                  code3: \"\",\n                  code4: \"\",\n                  code5: \"\",\n                  code6: \"\"\n                });\n                localStorage.setItem('token', res.data.data.token);\n                localStorage.setItem('userData', JSON.stringify(res.data.data.userData));\n                console.log(res, \"verifyOtp\", localStorage);\n                signUp();\n              } else {// alert(\"otp verification failed\")\n              }\n\n            case 8:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function signUpVerify() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var signInVerify = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var url, code, isNewUser, data, res;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              url = \"\".concat(auth_url, \"/user/verifySignInByEmailPhone\");\n              code = otp.code1 + otp.code2 + otp.code3 + otp.code4 + otp.code5 + otp.code6;\n              isNewUser = false;\n              data = {\n                emailIdMobileNo: emailIdMobileNo,\n                isNewUser: isNewUser,\n                code: code\n              };\n              _context4.next = 6;\n              return axios.post(url, data);\n\n            case 6:\n              res = _context4.sent;\n\n              if (res.status === 200 || res.status == \"success\") {\n                setOtp({\n                  code1: \"\",\n                  code2: \"\",\n                  code3: \"\",\n                  code4: \"\",\n                  code5: \"\",\n                  code6: \"\"\n                });\n                localStorage.setItem('token', res.data.data.token);\n                localStorage.setItem('userData', JSON.stringify(res.data.data.userData));\n                console.log(res, \"verifyOtp\", localStorage); // if(isNewUser===false){\n                //     dispatch(userDetails(res.data.data.token));\n                //     dispatch(userToken(res.data.data.userData));\n                // }\n\n                props.toggle();\n              } else {// alert(\"otp verification failed\")\n              }\n\n            case 8:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function signInVerify() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var signUp = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      var url, res;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              url = \"\".concat(auth_url, \"/user/signup\");\n              console.log(signUpData, \"signUpData\");\n              _context5.next = 4;\n              return axios.post(url, signUpData);\n\n            case 4:\n              res = _context5.sent;\n\n              if (res.status === 200 || res.status === \"success\") {\n                console.log(res.data, \"signUp\");\n                dispatch(userDetails(res.data.data.token));\n                dispatch(userToken(res.data.data.userData));\n                props.toggle();\n                setSignUpData({\n                  name: '',\n                  emailId: '',\n                  mobileNo: '',\n                  userTypeId: 3,\n                  mobileVerifyStatus: 1\n                });\n              } else if (res.status === 400) {// alert(\"User Already has Registered\");\n              }\n\n            case 6:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function signUp() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var handleSignUpData = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(e) {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              e.preventDefault();\n              handleIsSignup(true);\n              setemailIdMobileNo(signUpData.mobileNo);\n              sendSignUpOtp();\n\n            case 4:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function handleSignUpData(_x3) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var sendSignUpOtp = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n      var url, isNewUser, data, res;\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              handleIsSignup(false);\n              url = \"\".concat(auth_url, \"/user/signInByEmailPhone\");\n              isNewUser = true;\n              data = {\n                \"emailIdMobileNo\": signUpData.mobileNo,\n                \"isNewUser\": true\n              };\n              _context7.next = 6;\n              return axios.post(url, data);\n\n            case 6:\n              res = _context7.sent;\n\n              if (res.status === 200 || res.status === \"success\") {\n                handelOtp();\n              }\n\n            case 8:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function sendSignUpOtp() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  function handleEnter(event) {\n    console.log(event.keyCode, \"sdfgsdhsdf\");\n    var form = event.target.form;\n    var index = Array.prototype.indexOf.call(form, event.target);\n    console.log(form, index, \"sdfgsdhsdf\");\n\n    if (index !== 5) {\n      form.elements[index + 1].focus();\n      event.preventDefault();\n    }\n  }\n\n  function handleBackspace(event) {\n    console.log(event.keyCode, \"sdfgsdhsdf\");\n    var form = event.target.form;\n    var index = Array.prototype.indexOf.call(form, event.target);\n    console.log(form, index, \"sdfgsdhsdf\");\n\n    if (index !== 0) {\n      form.elements[index - 1].focus();\n      event.preventDefault();\n    }\n  }\n\n  return __jsx(Modal, {\n    isOpen: props.modal,\n    toggle: props.toggle,\n    className: styles.signInUpModal\n  }, which === 0 ? __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-5\"\n  }, __jsx(\"div\", {\n    className: styles.signIn\n  }, __jsx(\"div\", {\n    className: styles.signInCard\n  }, __jsx(\"form\", {\n    method: \"post\",\n    onSubmit: handleSignInData\n  }, __jsx(\"div\", {\n    className: styles.signinInput\n  }, __jsx(\"p\", {\n    className: styles.signinHeader\n  }, \"Welcome to MrMed\"), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.singninFormInput,\n    name: \"mobileNo\",\n    placeholder: \"Mobile number\",\n    value: emailIdMobileNo,\n    onChange: function onChange(e) {\n      return setemailIdMobileNo(e.target.value);\n    },\n    required: true\n  })), __jsx(\"div\", {\n    className: styles.signinBtns\n  }, __jsx(\"button\", {\n    className: styles.verifyBtn\n  }, \"VERIFY NUMBER\"), __jsx(\"p\", {\n    className: styles.noAccount\n  }, \"Don't have account ? \", __jsx(\"span\", {\n    className: styles.register,\n    onClick: handelSignUp\n  }, \"Register\"))))))), __jsx(\"div\", {\n    className: \"col-md-7\"\n  }, __jsx(CarouselForAll, null))) : \"\", which === 1 ? __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-5\"\n  }, __jsx(\"div\", {\n    className: styles.signUp\n  }, __jsx(\"div\", {\n    className: styles.signupContent\n  }, __jsx(\"div\", null, __jsx(\"p\", {\n    className: styles.signupHeader\n  }, \"Welcome to MrMed\"), __jsx(\"p\", {\n    className: styles.register\n  }, \"Register\"), __jsx(\"form\", {\n    method: \"post\",\n    onSubmit: handleSignUpData\n  }, __jsx(\"div\", {\n    className: styles.signupMain\n  }, __jsx(\"input\", {\n    type: \"text\",\n    className: styles.signupFormInput,\n    name: \"name\",\n    placeholder: \"Name\",\n    value: signUpData.name,\n    onChange: function onChange(e) {\n      return onChangeForm(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.signupFormInput,\n    name: \"emailId\",\n    placeholder: \"Email Address\",\n    value: signUpData.emailId,\n    onChange: function onChange(e) {\n      return onChangeForm(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.signupFormInput,\n    name: \"mobileNo\",\n    placeholder: \"MobileNumber\",\n    value: signUpData.mobileNo,\n    onChange: function onChange(e) {\n      return onChangeForm(e);\n    },\n    required: true\n  })), __jsx(\"button\", {\n    className: styles.sverifyBtn\n  }, \"SIGN UP\"))), __jsx(\"div\", {\n    className: styles.accountsMain\n  }, __jsx(\"div\", {\n    className: styles.nosignAccooun\n  }, __jsx(\"p\", {\n    className: styles.nosignupAccount\n  }, \"Already have an account ? \", __jsx(\"span\", {\n    onClick: handelSignIn\n  }, \"Login\"))), __jsx(\"div\", {\n    className: styles.signupFooter\n  }, __jsx(\"p\", {\n    className: styles.termsCont\n  }, \"By continuing  you agree to the to our \", __jsx(\"span\", null, \"Terms of use and Privacy policy\"))))))), __jsx(\"div\", {\n    className: \"col-md-7\"\n  }, __jsx(CarouselForAll, null))) : \"\", which === 2 ? __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-5\"\n  }, __jsx(\"div\", {\n    className: styles.otpLogin_inner\n  }, __jsx(\"div\", {\n    className: styles.textContent\n  }, __jsx(\"p\", {\n    className: styles.otp_header\n  }, \"Verify OTP\"), __jsx(\"p\", {\n    className: styles.otp_number\n  }, \"Please enter the OTP code sent to your \", __jsx(\"br\", null), \" mobile number +91 \", emailIdMobileNo)), __jsx(\"form\", {\n    method: \"post\",\n    onSubmit: verifyOtp\n  }, __jsx(\"div\", {\n    className: styles.otpno_container,\n    id: \"otp-screen\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code1\",\n    value: otp.code1,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    maxLength: \"1\",\n    required: true,\n    placeholder: \"0\"\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code2\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code2,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code3\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code3,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code4\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code4,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code5\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code5,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    required: true\n  }), __jsx(\"input\", {\n    type: \"text\",\n    className: styles.otp_form_input,\n    name: \"code6\",\n    placeholder: \"0\",\n    maxLength: \"1\",\n    value: otp.code6,\n    onChange: function onChange(e) {\n      return onChangeOtp(e);\n    },\n    required: true\n  })), __jsx(\"div\", {\n    className: styles.btnContainer\n  }, __jsx(\"button\", {\n    className: styles.otp_verify\n  }, \"VERIFY\"))))), __jsx(\"div\", {\n    className: \"col-md-7\"\n  }, __jsx(CarouselForAll, null))) : \"\");\n}","map":null,"metadata":{},"sourceType":"module"}